// ðŸ” KQL Playground: WHERE Clause Examples
// -----------------------------------------------------------
// The `where` operator filters rows that match a condition.
// Think of it like a "WHERE" clause in SQL.
// -----------------------------------------------------------


// ðŸ”¹ 1. Filter for events by a specific user
SecurityEvent
| where Account == "Administrator"
| take 5


// ðŸ”¹ 2. Filter for specific Event ID (e.g., 4625 = failed logon)
SecurityEvent
| where EventID == 4625
| take 5


// ðŸ”¹ 3. Combine multiple conditions using AND/OR
SecurityEvent
| where EventID == 4625 and Account == "admin"
| take 5


// ðŸ”¹ 4. Use the `in` operator to filter for multiple values
SecurityEvent
| where EventID in (4624, 4625, 4634)
| project TimeGenerated, EventID, Account


// ðŸ”¹ 5. Filter events in the last 1 hour using `ago()`
SecurityEvent
| where TimeGenerated > ago(1h)
| take 5


// ðŸ”¹ 6. Use string operators: contains, startswith, endswith
SecurityEvent
| where Account contains "adm"
| project Account, EventID


// ðŸ”¹ 7. Use `!` (NOT) to exclude results
SecurityEvent
| where Account !contains "test"
| where EventID != 4624
| take 5


// -----------------------------------------------------------
// ðŸ” COMMON COMPARISON OPERATORS:
// ==      equals
// !=      not equals
// > <     greater than / less than (for time, numbers)
// in ()   matches any in list
// contains, startswith, endswith = string filters
//
// Use `ago(time)` for time-based filters (e.g., last 1h, 1d, 30m)
// -----------------------------------------------------------
